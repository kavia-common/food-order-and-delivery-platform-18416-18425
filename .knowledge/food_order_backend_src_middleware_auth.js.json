{"is_source_file": true, "format": "JavaScript", "description": "This file defines middleware functions for authentication and authorization in an Express.js application, handling JWT token verification and role-based access control.", "external_files": ["jsonwebtoken"], "external_methods": ["jwt.verify"], "published": ["authMiddleware", "authorizeRoles"], "classes": [], "methods": [{"name": "authMiddleware(required = true)", "description": "Middleware that verifies JWT in the Authorization header, attaches user info to the request, or responds with an error on failure.", "scope": "", "scopeKind": ""}, {"name": "authorizeRoles(...roles)", "description": "Middleware that checks if the current user has one of the specified roles, responding with an error if unauthorized.", "scope": "", "scopeKind": ""}], "calls": ["jwt.verify"], "search-terms": ["authMiddleware", "authorizeRoles", "JWT", "token verification", "role-based access"], "state": 2, "file_id": 13, "knowledge_revision": 28, "git_revision": "", "ctags": [{"_type": "tag", "name": "authMiddleware", "path": "/home/kavia/workspace/code-generation/food-order-and-delivery-platform-18416-18425/food_order_backend/src/middleware/auth.js", "pattern": "/^function authMiddleware(required = true) {$/", "language": "JavaScript", "kind": "function", "signature": "(required = true)"}, {"_type": "tag", "name": "authMiddleware", "path": "/home/kavia/workspace/code-generation/food-order-and-delivery-platform-18416-18425/food_order_backend/src/middleware/auth.js", "pattern": "/^module.exports = { authMiddleware, authorizeRoles };$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "authorizeRoles", "path": "/home/kavia/workspace/code-generation/food-order-and-delivery-platform-18416-18425/food_order_backend/src/middleware/auth.js", "pattern": "/^function authorizeRoles(...roles) {$/", "language": "JavaScript", "kind": "function", "signature": "(...roles)"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/food-order-and-delivery-platform-18416-18425/food_order_backend/src/middleware/auth.js", "pattern": "/^      req.user = { id: payload.sub, role: payload.role || 'user' };$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "jwt", "path": "/home/kavia/workspace/code-generation/food-order-and-delivery-platform-18416-18425/food_order_backend/src/middleware/auth.js", "pattern": "/^const jwt = require('jsonwebtoken');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/code-generation/food-order-and-delivery-platform-18416-18425/food_order_backend/src/middleware/auth.js", "pattern": "/^      req.user = { id: payload.sub, role: payload.role || 'user' };$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/food-order-and-delivery-platform-18416-18425/food_order_backend/src/middleware/auth.js", "pattern": "/^      req.user = { id: payload.sub, role: payload.role || 'user' };$/", "language": "JavaScript", "kind": "class", "scope": "req", "scopeKind": "class"}], "hash": "ec295396f69e755673aa1a14ebcad420", "format-version": 4, "code-base-name": "food_order_backend", "filename": "food_order_backend/src/middleware/auth.js", "fields": [{"name": "module.exports = { authMiddleware, authorizeRoles };", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "req.user = { id: payload.sub, role: payload.role || 'user' };", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"28": ""}]}